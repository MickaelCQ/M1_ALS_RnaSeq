% --- Langue et encodage ---
\usepackage[french,english]{babel} % Langue du document
\usepackage[T1]{fontenc} % Codage des caractères pour la gestion des accents
\usepackage[utf8]{inputenc} % Encodage UTF-8
\usepackage{paracol}
\usepackage{wasysym}
% --- Mise en page ---
\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry} % Gestion des marges
\usepackage{setspace} % Gestion des espaces interlignes
\usepackage{titlesec} % Personnalisation des titres de sections
\usepackage{titling} % Personnalisation du titre
\usepackage{fancyhdr} % Personnalisation des en-têtes et pieds de page
\usepackage{lastpage} 
% --- Mathématiques ---
\usepackage{mathtools} % Paquet pour des équations et symboles mathématiques
\usepackage{siunitx} % Écriture avec la notation scientifique
\usepackage{pgfplots}

% --- Flottants et images ---
\usepackage[section]{placeins} % Forcer les flottants à rester dans les sections
\usepackage{graphicx} % Insérer des images
\usepackage[justification=centering]{caption} % Légendes centralisées
\usepackage{subcaption} % Sous-légendes pour des figures
\usepackage{wallpaper} % Utiliser des fonds ou des images de fond
\usepackage{wrapfig} % Mise en page personnalisée pour les images

% --- Tableaux ---
\usepackage{array,multirow,makecell} % Personnalisation avancée des tableaux
\usepackage{booktabs} % Amélioration des tables (lignes fines, moyennes, épaisses)
\usepackage{colortbl} % Coloration des cellules de tableaux
\usepackage{diagbox} % Pour créer des cellules en diagonale
\usepackage{longtable} % Tables sur plusieurs pages

% --- Code source ---
\usepackage{minted} % Mise en forme de code source avec coloration syntaxique
\usepackage{listings} % Insertion et mise en forme du code source

% --- graphie et références ---
\usepackage[backend=biber]{biblatex} % Gestion de la bibliographie
\addbibresource{./references.bib}

\usepackage{csquotes} % Gestion des guillemets typographiques
\usepackage{hyperref} % Liens hypertexte sans surlignage
\usepackage{cleveref} % Références intelligentes

% --- Textes et acronymes ---
\usepackage{lipsum} % Générer du texte de remplissage
\usepackage{acro} % Gestion des acronymes
\usepackage{nomencl} % Création d'une nomenclature (glossaire)
\makenomenclature % Commande pour générer la nomenclature

% --- Dessins et graphiques ---
\usepackage{tikz} % Nécessaire pour smartdiagram
\usetikzlibrary{shapes.geometric, arrows.meta, calc, positioning}
\usepackage{eso-pic} % Gestion d'images en arrière-plan
\usepackage{tcolorbox} % Création de boîtes de couleur pour des équations ou du texte
\usepackage{smartdiagram} % Créer les figures simplement
\usesmartdiagramlibrary{additions} %Dépendances smartdiagram

% --- Divers ---
\usepackage{appendix} % Gérer les annexes
\usepackage{multicol} % Texte en colonnes
\usepackage{lastpage} % Référence à la dernière page
\usepackage{ragged2e} % Justification d'un texte à l'intérieur d'un parbox

\definecolor{darkpurple}{RGB}{102,0,153}
\definecolor{darkblue}{rgb}{0.0, 0.3, 0.6} % Bleu foncé pour les sections
\definecolor{darkgreen}{rgb}{0.0, 0.5, 0.0}  % Vert foncé
\definecolor{darkred}{rgb}{0.5, 0.0, 0.0}    % Rouge foncé
\definecolor{darkblack}{rgb}{0.1, 0.1, 0.1}  % Noir foncé (légèrement moins intense que le noir pur)
\definecolor{darkyellow}{RGB}{153,102,0}
\definecolor{darkgray}{RGB}{64,64,64}

% Formatage des sections
\titleformat{\section}[block]
  {\normalfont\Large\bfseries\rmfamily\color{darkblue}} % Police, taille, graisse et couleur
  {\thesection}{1em}{}[\titlerule] % Numérotation et ligne sous le titre
\titlespacing{\section}{5pt}{10pt}{10pt} % Espacement avant et après
\renewcommand{\labelitemi}{\textemdash}
% Formatage des sous-sections
\titleformat{\subsection}[block]
  {\normalfont\large\bfseries\rmfamily\color{darkblue}} % Police, taille, graisse et couleur
  {\thesubsection}{1em}{} % Numérotation
\titlespacing{\subsection}{5pt}{8pt}{5pt} % Espacement avant et après

% Formatage des sous-sous-sections
\titleformat{\subsubsection}[block]
  {\normalfont\normalsize\bfseries\rmfamily\color{darkblue}} % Police, taille, graisse et couleur
  {\thesubsubsection}{1em}{} % Numérotation
\titlespacing{\subsubsection}{5pt}{8pt}{5pt} % Espacement avant et après

% Appliquer les liens en bleu et soulignés uniquement dans la bibliographie
\AtEndPreamble{
    \hypersetup{
        colorlinks=true,  % Active les liens colorés
        linkcolor=black,   % Lien dans le texte
        urlcolor=darkblue,    % Lien URL dans le texte
        filecolor=black    % Lien vers les fichiers
    }
}
% Redéfinir ma commande \bibliography pour personnaliser les liens
\usepackage{etoolbox}
\pretocmd{\bibliography}{%
  \hypersetup{
    colorlinks=true,  % Active les liens colorés
    linkcolor=black,   % Lien dans le texte
    urlcolor=black,    % Lien URL dans la bibliographie
    filecolor=black    % Lien vers les fichiers
  }%
}{}{}
\hypersetup{
    citecolor=darkblue,  % Couleur des références dans le texte
}

%_________________________ Montage du contour ____________________

\AtBeginShipout{
    \begin{tikzpicture}[remember picture, overlay]
        \draw [line width=0.1mm,lightgray] 
            ($(current page.north west) + (0.5cm,-0.5cm)$) 
            rectangle 
            ($(current page.south east) + (-0.5cm,0.5cm)$);
    \end{tikzpicture}
}
%---------------------------Diagramme de conclusion ----------------------------------------

% Définition de la mise en forme listing (pour l'intégration des codes et pseudoCode)
\definecolor{background}{HTML}{F1F1F0}
\definecolor{string}{HTML}{DD1144}
\definecolor{keyword}{HTML}{0077AA}
\definecolor{comment}{HTML}{44AA99}
\definecolor{identifier}{HTML}{000000}
\definecolor{framecolor}{HTML}{CCCCCC}

\definecolor{background}{HTML}{F1F1F0}
\definecolor{string}{HTML}{DD1144}
\definecolor{keyword}{HTML}{0077AA}
\definecolor{comment}{HTML}{44AA99}
\definecolor{identifier}{HTML}{000000}
\definecolor{framecolor}{HTML}{CCCCCC}

\lstset{
  backgroundcolor=\color{background}, % Couleur de fond
  basicstyle=\small\ttfamily, % Taille et police par défaut
  keywordstyle=\color{blue}, % Mots-clés en bleu
  commentstyle=\color{comment}, % Commentaires
  stringstyle=\color{string}, % Chaînes de caractères
  identifierstyle=\color{identifier}, % Identifiants
  numbers=left, % Numérotation des lignes
  numberstyle=\tiny\color{gray}, % Style de numérotation
  language=bash, % Langage utilisé (bash)
  frame=single, % Encadrement du code
  rulecolor=\color{framecolor}, % Couleur du cadre
  framesep=2pt, % Espacement autour du code
  framerule=0.5pt, % Épaisseur du cadre
  breaklines=true, % Retour à la ligne si le code est trop long
  morekeywords={grep, cut, tr, efetch, nano, build, touch, apptainer, run, shell}, % Ajouter && comme un mot-clé
  emph={\&\&}, % Emphases supplémentaires
  emphstyle=\color{red}, % Met en rouge les opérateurs &&
  inputencoding=utf8, % Encodage UTF-8 pour les caractères spéciaux
  extendedchars=true, % Permet l'utilisation des caractères spéciaux
  showstringspaces=false,
  literate=%
    {é}{{\'e}}1
    {è}{{\`e}}1
    {ê}{{\^e}}1
    {ë}{{\¨e}}1
    {à}{{\`a}}1
    {ç}{{\c{c}}}1
    {ù}{{\`u}}1
    {û}{{\^u}}1
    {î}{{\^i}}1
    {ï}{{\¨i}}1
    {ô}{{\^o}}1
}
\lstset{
  language=C++,                           % Langage utilisé
  basicstyle=\ttfamily\footnotesize,      % Police de base (taille et type)
  keywordstyle=\color{blue}\bfseries,      % Couleur et style des mots-clés
  commentstyle=\color{green!50!black},      % Couleur des commentaires
  stringstyle=\color{red},                  % Couleur des chaînes de caractères
  numbers=left,                           % Numérotation des lignes à gauche
  numberstyle=\tiny\color{gray},            % Style de la numérotation
  stepnumber=1,                           % Numérotation toutes les lignes
  numbersep=5pt,                          % Distance entre la numérotation et le code
  tabsize=4,                              % Taille des tabulations
  showspaces=false,                       % Ne pas afficher les espaces spéciaux
  showstringspaces=false,                 % Ne pas afficher les espaces dans les chaînes
  breaklines=true,                        % Retour à la ligne automatique
  breakatwhitespace=true,                 % Retour à la ligne uniquement aux espaces
  captionpos=b,                           % Position de la légende (b pour bottom)
  frame=single,                           % Encadrement du listing
  rulesepcolor=\color{gray}               % Couleur de la ligne d'encadrement
}
% Définir une couleur pour le code Makefile
\definecolor{makefilecolor}{rgb}{0.13, 0.13, 0.13}


% Définir une couleur de fond sobre et élégante
\definecolor{makefileBackground}{rgb}{0.95, 0.95, 1}  % Gris très clair
\definecolor{makefileKeyword}{rgb}{0.2, 0.2, 0.6}  % Bleu profond pour les mots-clés
\definecolor{makefileComment}{rgb}{0.2, 0.6, 0.2}  % Vert pour les commentaires
\definecolor{makefileString}{rgb}{0.7, 0.1, 0.1}  % Rouge foncé pour les chaînes de caractères

% Définir un style de code élégant et lisible pour Makefile
\lstdefinestyle{makefileStyle}{
  language=sh,  % Langage shell pour Makefile
  basicstyle=\ttfamily\small,  % Police monospace, taille réduite pour les articles scientifiques
  backgroundcolor=\color{makefileBackground},  % Fond clair et discret
  keywordstyle=\color{makefileKeyword}\bfseries,  % Style pour les mots-clés (en bleu et gras)
  commentstyle=\color{makefileComment}\itshape,  % Style pour les commentaires (en vert et italique)
  stringstyle=\color{makefileString},  % Style pour les chaînes de caractères (en rouge)
  breaklines=true,  % Gestion automatique du retour à la ligne
  frame=single,  % Bordure autour du code
  rulesepcolor=\color{black},  % Séparateur noir pour les lignes de cadre
  columns=fullflexible,  % Colonnes flexibles pour un alignement parfait
  morekeywords={$(MSG), $(MSQ), $(RM), $(Doxy), doxygen, pdflatex, firefox, evince},  % Mots-clés spécifiques à Makefile
  xleftmargin=2em,  % Marge gauche pour une meilleure lisibilité
  numberstyle=\tiny\color{gray},  % Style des numéros de ligne
  numbers=left,  % Numéros de ligne à gauche
  stepnumber=1,  % Incrément des numéros de ligne
  numbersep=5pt,  % Espacement entre les numéros de ligne et le code
  showstringspaces=false,  % Ne pas afficher d'espace pour les chaînes
  moredelim=**[is][\color{magenta}]{@}{@}  % Ajouter un délimiteur spécifique si nécessaire
}
% Définition du caption lstlisting
\renewcommand{\lstlistingname}{Code}

% Environnement spécifique pour Makefile
\lstnewenvironment{makefile}[1][]{
  \lstset{style=makefileStyle, #1}
}{}

\usepackage{amsmath, amssymb}
%_________________________ Définition de la bibliographie ____________________
\title{Rapport DevOPS M1} %Titre du fichier

% Définir un nouvel environnement de flottant 
\newfloat{listing}{htbp}{lop}
\floatname{listing}{Code}
\newenvironment{lexique}{\begin{itemize}[itemsep=-5pt, left=0pt]}{\end{itemize}}

%__________Montage de la table des abbréviation___________

\setlength{\arrayrulewidth}{0.5mm}
\setlength{\tabcolsep}{10pt} % Ajuste l'espace entre les colonnes
\renewcommand{\arraystretch}{0.9} % Ajuste l'espacement des lignes
%_________________________ Montage du Smartdiagram  ____________________


%-------------------------------------------------------------------------------------------------
%                              DEFINITIONS DU GLOSSAIRE 
%-------------------------------------------------------------------------------------------------
%________________________Définition de la mise en forme  des pieds de pages et en-tête ___________________
%Définir un fond d'image pour les pages sauf la première

\newcommand{\fairemarges}{
    \makenomenclature
    \pagestyle{fancy}
    \fancyhf{} % Réinitialise les en-têtes et pieds de page

    \setlength{\footskip}{-35pt} % Hauteur du pied de page
    \setlength{\headheight}{-10pt} % Hauteur de l'en-tête
    \setlength{\headsep}{0pt} % Espacement entre l'en-tête et le texte 
    % Contenu du pied de page
% Pied de page

\fancyfoot[L]{
    {\sffamily \Large \textbf{\thepage}} / \pageref{LastPage}
}

\fancyfoot[R]{
    {\sffamily \normalsize \textit{\nouppercase{\leftmark}}}
}  
    \renewcommand{\footrulewidth}{0.3pt} % Épaisseur de la ligne du pied de page
    \renewcommand{\headrulewidth}{0pt} % Épaisseur de la ligne de l'en-tête

    % Couleur des lignes
    \renewcommand{\footrule}{{\color{darkblue}\hrule width\headwidth height\footrulewidth \vskip-\footrulewidth}}
    \renewcommand{\headrule}{{\color{darkblue}\hrule width\headwidth height\headrulewidth \vskip-\headrulewidth}}
}

\fairemarges % Applique les marges et configurations

\onehalfspacing


%-----------------------------Algorithmes -------------------------
\usepackage[linesnumbered, ruled, vlined]{algorithm2e}
\usepackage{algpseudocode}   % Pseudocode dans les algorithmes
\makeatletter
\algrenewcommand\ALG@beginalgorithmic{\normalfont\sffamily} 
\makeatother

% Définition des couleurs
\definecolor{bleumarine}{rgb}{0.0, 0.0, 0.5} % Bleu marine
\definecolor{rouge}{rgb}{0.8, 0.0, 0.0} % Rouge
\definecolor{fonction}{rgb}{0.0, 0.5, 0.4}
\definecolor{commentaire}{RGB}{100, 140, 100} 

% Personnalisation des mots-clés français
\SetKw{KwPour}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Pour}}
\SetKw{KwFinPour}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Fin Pour}}
\SetKw{KwSi}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Si}}
\SetKw{KwFinSi}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Fin Si}}
\SetKw{KwSinon}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Sinon}}
\SetKw{KwTantQue}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Tant Que}}
\SetKw{KwFinTantQue}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Fin Tant Que}}
\SetKw{KwRetourner}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Retourner}}
\SetKw{KwDebut}{\sffamily \textcolor{bleumarine}{Début}}
\SetKw{KwFin}{\sffamily \textcolor{bleumarine}{Fin}}
\SetKw{KwVariables}{\sffamily \textcolor{bleumarine}{Variables}}
\SetKw{KwFaire}{\sffamily \textcolor{bleumarine}{Faire :}}
\SetKw{KwAlors}{\sffamily \textcolor{bleumarine}{Alors :}}
\SetKw{KwEt}{\textcolor{bleumarine}{ ET }}
\SetKw{KwAfficher}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Afficher}}
\SetKw{KwFonction}{\hspace{-1cm}\sffamily {Fonction}}
\SetKw{KwOuvrir}{\hspace{-1cm}\sffamily {Ouvrir}}
\SetKw{KwTrier}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{Trier}}
\SetKw{KwA}{\hspace{-1cm}\sffamily \textcolor{bleumarine}{A}}


% Configuration des numéros de ligne et indentations
\SetKwProg{Fn}{\vspace*{-2mm}\hspace{-5mm}}{}
\SetNlSty{}{} %Numéro de ligne
\SetAlgoNlRelativeSize{-1} % Ajustement des numéros de ligne

\newcommand{\CxCons}{\hspace{5mm}{\textcolor{gray}{O(1)}}} % constante
\newcommand{\CxLin}{\hspace{5mm}{\textcolor{gray}{O(n)}}} %linéaire
\newcommand{\CxQuad}{\hspace{5mm}{\textcolor{gray}{O(n^2)}}} % quadratique
\newcommand{\CxCub}{\hspace{5mm}{\textcolor{gray}{O(n^3)}}} % cubique
\newcommand{\CxPoly}{\hspace{5mm}{\textcolor{gray}{O(n^k)}}} % polynomiale
\newcommand{\CxExp}{\hspace{5mm}{\textcolor{gray}{O(2^n)}}} % exponentielle
\newcommand{\CxFact}{\hspace{5mm}{\textcolor{gray}{O(n!)}}} % factorielle
\newcommand{\CxLogLin}{\hspace{5mm}{\textcolor{gray}{O(n $\log$ n)}}} % n log n
%-----------------------------FIN Algorithmes -------------------------


% Couleurs élégantes pour le code
\definecolor{bgcolor}{rgb}{0.95,0.95,0.95}   % Fond gris clair
\definecolor{commentcolor}{rgb}{0,0.5,0}      % Vert foncé pour les commentaires
\definecolor{keywordcolor}{rgb}{0,0,0.6}      % Bleu pour les mots-clés
\definecolor{stringcolor}{rgb}{0.6,0.2,0}     % Marron pour les chaînes
\definecolor{numbercolor}{rgb}{0.6,0,0}       % Rouge foncé pour les nombres

% Configuration avancée de listings
\lstdefinestyle{cppStyle}{
    language=C++,
    backgroundcolor=\color{bgcolor},
    basicstyle=\ttfamily\footnotesize,  % Police typewriter
    keywordstyle=\bfseries\color{keywordcolor},
    commentstyle=\itshape\color{commentcolor},
    stringstyle=\color{stringcolor},
    numberstyle=\tiny\color{numbercolor},
    numbers=left,
    numbersep=8pt,
    breaklines=true,
    breakatwhitespace=true,
    showstringspaces=false,
    frame=single,                        % Encadrement du code
    rulecolor=\color{black},              % Bordure noire
    captionpos=b,                         % Légende en bas
    tabsize=4,
    morekeywords={constexpr, nullptr, override, final},  % Ajout de mots-clés récents
    escapeinside={(*@}{@*)},               % Permet d'insérer du LaTeX dans le code
}
\renewcommand{\ttdefault}{pcr}  % Utilisation de Courier pour le code

\tikzstyle{commit} = [circle, minimum size=6mm, draw=blue!80, fill=blue!30, font=\footnotesize, text centered]
\tikzstyle{process} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=orange!30]
\tikzstyle{arrow} = [thick,->,>=stealth]
% Configuration du style des captions
\captionsetup{
    labelfont={color=darkblue,bf}, % Met le label (ex. : "Figure") en bleu foncé et en gras
    font=small % Taille du texte des captions
}

% Définition des styles
\tikzstyle{nodebase} = [rectangle, rounded corners, minimum width=6cm, minimum height=1cm, text centered, draw=black, thick]
\tikzstyle{localrepo} = [nodebase, fill=blue!20, draw=white!60, thick, drop shadow]
\tikzstyle{remoterepo} = [nodebase, fill=red!20, draw=white!60, thick, drop shadow]
\tikzstyle{commit} = [circle, minimum size=0.8cm, draw=black, fill=gray!30, thick, drop shadow]
\tikzstyle{arrow} = [ultra thick, ->, >=Stealth, draw=black!80, line cap=round, shorten >=1pt, shorten <=1pt]
